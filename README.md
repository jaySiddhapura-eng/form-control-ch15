# Template Driven Form Control

## Table of Contents  
* [Introduction](#Introduction)<br>
* [Adding The Form Module](#Adding-The-Form-Module)<br>
* [Registering The Input Controls](#Registering-The-Input-Controls)<br>
* [Accessing The form Object Outside HTML](#Accessing-The-form-Object-Outside-HTML)<br>
* [Accessing Form Control Using ViewChild](#Accessing-Form-Control-Using-ViewChild)<br>
* [Adding Validators](#Adding-Validators)<br>
* [Accessing Form State](#Accessing-Form-State)<br>
* [NgModel with Two Way Binding](#NgModel-with-Two-Way-Binding)<br>
* [Grouping Form Control](#Grouping-Form-Control)<br>
* [Adding Radio Button](#Adding-Radio-Button)<br>
* [Show Back The Submitted Data](#Show-Back-The-Submitted-Data)<br>
* [Resetting The Form](#Resetting-The-Form)<br>

## Introduction

## 	[:arrow_up:](#Table-of-Contents )<br>

1. Angular have capability to convert HTML Form into Typescript Object
2. This converted object can hold data as well as meta data
3. Data: Actual data obtain from input fields of HTML Form 
4. Meta data: Supplement data of Form such as validity of form etc
5. There are two approaches to implement form with Angular
   1. Template - Driven (TD) : In this approach Angular infers the Form object from the DOM
   2. Reactive : In this approach form is created programmatically and synchronized with DOM  

## Adding The Form Module

## 	[:arrow_up:](#Table-of-Contents )<br>

~~~typescript
import { FormsModule } from '@angular/forms';

@NgModule({
    imports: [ FormsModule ]
})
~~~

1. Adding form module in ```app.module.ts``` file of the  application
2. Angular generate / recognize ```<form> </form> ``` tag by itself automatically
3. Angular basically converts the HTML Form into JSON object, Although this object is not visible by default
4. Therefore, developer need to register control manually to inform Angular about various form controls which are presents in between form tags

## Registering The Input Controls

## 	[:arrow_up:](#Table-of-Contents )<br>

1. Adding ```ngModel``` and ```name``` to all the inputs which we need to register with Angular 

   ~~~html
   <div class="form-group">
               <label for="username">Username</label>
               <input type="text" 
                      id="username" 
                      class="form-control"
                      ngModel
                      name = "username">
   </div>
   ~~~

2. Make the form submit-able

   ~~~html
   <form (ngSubmit)="onSubmit()">
       <!--All the form controls will come between form tags-->
   </form>
   ~~~

3. ```onSubmit()``` method will be auto wired with the buttons who has ```type ="submit"```

4. ```onSubmit()``` is implemented in corresponding .ts file

## Accessing The form Object Outside HTML

## 	[:arrow_up:](#Table-of-Contents )<br>

1. This task can be achieve by creating form reference and then passing this reference to the ```onSubmit``` method as a parameter

   ~~~html
   <!--app.component.html-->
   <form (ngSubmit) = "onSubmit(f)" #f = "ngForm">
       <!--Form controls-->
   </form>
   ~~~

2. In above code snippet ```#f``` holds the reference of the form

3. The value to the form reference is provided by ```ngForm```

4. The form reference is provided to the ```onSubmit(f)```

5. Accessing the form reference value

   ~~~typescript
   // app.component.ts
   export class AppComponent { 
   	onSubmit(frm:NgForm)
           console.log(frm);
       }
   }
   ~~~

6. Various property of Form provided by angular when form is generated by above method

   1. control: which type of control provided
   2. dirty: if user added any value in the input field
   3. submitted: whether form is submitted
   4. touched/untouched: whether user click on any of the input field

## Accessing Form Control Using ViewChild

## 	[:arrow_up:](#Table-of-Contents )<br>

1. When we pass the form reference into the submitting method, the data of form will be available to the .ts file only when this method get executed. In other word the form data available to the .ts only after it get submitted

2. Although the form data can be passed to the .ts file even before the submitting the form

3. To achieve this functionality ```@ViewChild``` is being used

4. Modify the HTML file as follow

   ~~~html
   <!--app.component.html-->
   <form (ngSubmit) = "onSubmit()" #f = "ngForm">
   </form>
   
   <!--form reference 'f' is not passed to the onSumbit() method-->
   ~~~

5. Accessing ```#f``` in .ts using ViewChild

   ~~~typescript
   export class AppComponent {
       @ViewChild('f',{static:true}) signupForm: NgForm;
       
       onSubmit(){
       	console.log(this.signupForm);
       }
   }
   ~~~

## Adding Validators

## 	[:arrow_up:](#Table-of-Contents )<br>

1. Validators are basically a rules which check the validity of user input in form control

2. Angular provide  a tool for validation, which can be used to highlight the valid/invalid user input

3. This highlight can be very useful to inform user about correcting invalid input

4. Add ```required``` HTML property in the form control

5. ```required``` tag basically means, if user missed to provide the input to the given field then form is invalid

6. ```Email``` This HTML property checks whether entered data is valid email address or not

   ~~~html
   <!--app.component.html-->
   <div class="form-group">
       <label for="email">Mail</label>
       <input type="email"
              id="email" 
              class="form-control"
              ngModel
              name="email"
              required
              email
   </div>
   ~~~

7. Whether form is valid/invalid it will be visible at form object generated by angular under ```valid``` property

8. Multiple ```valid``` tags are available at different levels in form object

## Accessing Form State 

## 	[:arrow_up:](#Table-of-Contents )<br>

1. Disable the submit button on invalid input

   ~~~html
   <button class="btn btn-primary" 
           type="submit"
           [disabled]="!f.valid">
   Submit
   </button>
   
   <!--[disabled] is the DOM property for button provided by HTML-->
   <!--'f' is the form reference which hold form meta data also-->
   <!--.valid : accessing valid property of the form meta data-->
   ~~~

2. Use CSS classes to highlight the invalid inputs

   ~~~css
   input.ng-invalid.ng-touched{
     border: 1px solid red;
   }
   
   /*ng-invalid and ng-touched are the classes attached to the input field by angular 
   during run time, if input is invalid or is touched respectively*/
   ~~~

3. Providing error message if input invalid

   ~~~html
   <div class="form-group">
        <label for="email">Mail</label>
        <input type="email" 
               id="email" 
               class="form-control"
               ngModel
               name="email"
               required
               email
               #em ="ngModel">
       
        <span class="help-block" *ngIf="!em.valid && em.touched">
             Please enter the valid email address!
        </span>
   </div>
   
   <!--#em is the reference of that perticular input control-->
   <!--every input control have their ngModel-->
   ~~~

4. Set default value using ```ngModel```

   ~~~html
   <div class="form-group">
        <label for="secret">Secret Questions</label>
        <select id="secret" 
                class="form-control"
                [ngModel]="defaultQuestion"
                name="secret">
               <option value="pet">Your first Pet?</option>
               <option value="teacher">Your first teacher?</option>
        </select>
           </div>
   ~~~

## NgModel with Two Way Binding

## 	[:arrow_up:](#Table-of-Contents )<br>

1. Three option for using ```ngModel``` in the form

   1. No binding : ```"ngModel"```
   2. One-way binding : ```[ngModel]```
   3. Two-way binding : ```[(ngModel)]```

2. Bind the text area data with .ts property

   ~~~html
   <!--app.component.html-->
   <div class="form-group">
      <textarea name="questionAnswer" 
                rows="2"
                [(ngModel)]="answer">
      </textarea>
   </div>
   <!--property answer is declared in app.component.ts file-->
   
   <!--accessing answer property of the app.component.ts-->
   <p>
       reply : {{answer}}
   </p>
   ~~~

## Grouping Form Control

## 	[:arrow_up:](#Table-of-Contents )<br>

~~~html
<form (ngSubmit) = "onSubmit()" #f = "ngForm">
        <div id="user-data" 
        ngModelGroup = "userData"
        #userData = "ngModelGroup">
            <input type="text"> username</input>
            <input type="text">Email</input>
        </div>   

	   <p *ngIf = "!userData.valid && userData.touched">user data invalid</p>

</form>

<!--render the paragraph if form group is invalid [not individual form control]-->
~~~

## Adding Radio Button

## 	[:arrow_up:](#Table-of-Contents )<br>

~~~html
<!--app.component.html-->
<div class="radio"
     *ngFor = "let g of genders">
         <label>
            <input type="radio"
                   name="gender"
                   ngModel
                   [value] ="g"
                   required
                   >
              	{{g}}
         </label>
</div>
~~~

~~~typescript
//app.component.ts
export class AppComponent { 
	genders = ['male', 'female'];
}
~~~

Set value / Patch value

1. Set value: This operation overwrite the entire form while updating just one input field

2. Set value is used when all the input field needed to be overwrite with new value

   ~~~typescript
   onSetUserName(){
       const suggestedName = 'Superuser';
       this.signupForm.form.setValue(
         	{
           	userData:{
             	username:suggestedName,
             	email:''
             	}, 
           	secret:'pet',
           	questionAnswer:'',
           	gender: 'male'
         	}
       );
     }
   
   // if u apply set value to change just one field then all other field become default or empty 
   // because set value overwrite entire form
   ~~~

3. Patch value : This approach of adding the value in the input field does not modify other input fields while modifying the particular input field

   ~~~typescript
   onPatchUserName(){
       	const suggestedName = 'SuperMan';
       	this.signupForm.form.patchValue(
         		{
           		userData:{
             		username:suggestedName
           		}
         		}
       	);
   }
   
   // only username will be modified with the new value, where as other fields will remain unmodified
   ~~~

## Show Back The Submitted Data

## 	[:arrow_up:](#Table-of-Contents )<br>

1. Store the data which arrived from form control into the local properties of .ts file

   ~~~typescript
   // app.component.ts
   // user is the local property which is being used to store the form control data
   export class AppComponent { 
   	  user = {
       	username:'',
       	email:'',
       	secretQuestion:'',
       	answer:'',
       	gender:''
     	  }
   
     	  submitted = false; // to show input data conditionally
       
         onSubmit(){
       		this.submitted =  true;
       		this.user.username = this.signupForm.value.userData.username;
       		this.user.email = this.signupForm.value.userData.email;
       		this.user.secretQuestion = this.signupForm.value.secret;
       		this.user.answer = this.signupForm.value.questionAnswer;
       		this.user.gender = this.signupForm.value.gender;
     		}   
   }
   ~~~

2. Display the above created/updated user data in HTML

   ~~~html
   <!--app.component.html-->
     <div class="row" *ngIf="submitted">
       	<div class="col-xs-12">
         		<h3>Your Submitted Data</h3>
         		<p>UserName: {{user.username}}</p>
         		<p>email: {{user.email}}</p>
         		<p>Secret Question: {{user.secretQuestion}}</p>
         		<p>Answer: {{user.answer}}</p>
         		<p>gender: {{user.gender}}</p>
       	</div>
     </div>
   ~~~

## Resetting The Form

## 	[:arrow_up:](#Table-of-Contents )<br>

1. After successful submission of the form, it must resets, means all the input data and meta data of form should be reset

   ~~~typescript
   export class AppComponent { 
       @ViewChild('f',{static:true}) signupForm: NgForm;
       
   	onSubmit(){ 
           this.signupForm.reset();
       	}
   }
   ~~~

   

